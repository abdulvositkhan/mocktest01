<!DOCTYPE html>
<html lang="uz">
<head>
<meta charset="UTF-8">
<title>Test natijalari</title>

<style>
body{
  margin:0;
  font-family:Arial;
  background:#ecfff7;
}
.container{
  max-width:1000px;
  margin:30px auto;
  background:#fff;
  border-radius:20px;
  padding:25px;
}
table{
  width:100%;
  border-collapse:collapse;
}
th,td{
  padding:10px;
  border-bottom:1px solid #ddd;
  text-align:center;
}
th{
  background:#f1f1f1;
}
.badge{
  padding:6px 12px;
  border-radius:20px;
  color:#fff;
}
.fail{background:#e74c3c}
.second{background:#e67e22}
.first{background:#f1c40f;color:#000}
.high{background:#3498db}
button{
  padding:6px 12px;
  cursor:pointer;
}
.detail{
  margin-top:20px;
}
.correct{background:#e9fbe9;border-left:5px solid #2ecc71;padding:10px}
.wrong{background:#fdeaea;border-left:5px solid #e74c3c;padding:10px}
</style>
</head>

<body>

<div class="container">

<h2>ğŸ“Š Admin â€” Test natijalari</h2>

<table>
<thead>
<tr>
<th>Ism</th>
<th>Familiya</th>
<th>Test ID</th>
<th>Ball</th>
<th>Toifa</th>
<th>Vaqt</th>
<th>Batafsil</th>
</tr>
</thead>
<tbody id="table"></tbody>
</table>

<div id="detail" class="detail"></div>

</div>

<script>
const results = JSON.parse(localStorage.getItem("results")||"[]");
const table = document.getElementById("table");
const detail = document.getElementById("detail");

function getCategory(score){
 if(score<60) return ["Oâ€˜tilmadi","fail"];
 if(score<70) return ["Ikkinchi toifa","second"];
 if(score<80) return ["Birinchi toifa","first"];
 return ["Oliy toifa","high"];
}

results.forEach((r,i)=>{
 const [text,cls]=getCategory(r.score);
 table.innerHTML+=`
 <tr>
  <td>${r.name}</td>
  <td>${r.surname}</td>
  <td>${r.testId}</td>
  <td>${r.score}/100</td>
  <td><span class="badge ${cls}">${text}</span></td>
  <td>${r.endTime}</td>
  <td><button onclick="show(${i})">ğŸ‘</button></td>
 </tr>`;
});

function show(i){
 const r=results[i];
 detail.innerHTML=`
 <h3>ğŸ“ ${r.name} ${r.surname}</h3>
 <p><b>Ball:</b> ${r.score}/100</p>
 <p><b>Test tugagan vaqt:</b> ${r.endTime}</p>
 <button onclick="window.print()">ğŸ“„ PDF yuklash</button>
 <hr>
 `;
 r.details.forEach((q,idx)=>{
   detail.innerHTML+=`
   <div class="${q.correct?'correct':'wrong'}">
     <b>${idx+1}. ${q.question}</b><br>
     Sizning javob: ${q.answer||"-"}<br>
     ${q.correct?"âœ” Toâ€˜gâ€˜ri":"âŒ Xato (Toâ€˜gâ€˜ri: "+q.right+")"}
   </div>`;
 });
}
</script>

</body>
</html>
